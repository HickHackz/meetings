# Malware in Residential Linux Systems

## Is Linux "more secure" than Windows?
- Why does it get fewer viruses?

- Actual OS security features
    - good filesystem permissions go a long way
    - separation between root & normal users

- How many people use the OS
    - Linux is common. Desktop Linux is rare.
- What kind of people use the OS
    - most desktop Linux users know *something* about computers
    - most Linux servers are operated by paid sysadmins

- How the OS is developed
    - FOSS means patches get written and published quicker
    - no more reliance on security by obscurity

---- Which of these reasons is most important? ----


# Linux used by non-computer-nerds

- Android
    - used in most phones worldwide!
    - Google's highly locked-down and modified Linux
    - we kept the separation of root and normal users...
    - but now you can't be root. sorry.
- IoT systems
    - some of the most vulnerable computer systems of the last decade
    - many are cheaply made
    - this includes security-forward devices like smart locks/fobs
- Residential Routers
    - very exposed to the Petri dish of the internet
    - can't hide behind a firewall if you are the firewall

# Linux used by individual computer nerds
    - Desktop Linux!





# Sliding Scale of Interactivity


Less                                                                   More
   <------------------------------------------------------------------>
      |             |                       |                   |
   Routers     IoT Devices                Phones            Desktops

Less interactive: the average user doesn't think of this as a computer
- Headless systems
- Shells or control panels not frequently used
- Most people don't download/run software on these machines
- Rarely restarted or updated

More interactive: these devices are used as personal computers
- Have GUIs
- "Control panels" like settings menus are frequently accessed
- Most people download/run external software
- Often restarted and updated



# Sliding Scale of Interactivity

- More interactive devices are vulnerable to social engineering

- Less interactive devices are often poorly secured

















# Router Malware

- Routers are a huge non-interactive attack surface
- Largely unsecured, running old software, rarely restarted
- "Trusted" position in a network
- Needs to communicate with devices in LAN and with ISP

- Router malware examples:
    - ZuoRAT https://www.malwarebytes.com/blog/news/2022/06/zuorat-is-a-sophisticated-malware-that-mainly-targets-soho-routers
    - other Mirai-based worms https://badcyber.com/new-mirai-attack-vector-bot-exploits-a-recently-discovered-router-vulnerability/
    - fun research https://arstechnica.com/information-technology/2013/03/guerilla-researcher-created-epic-botnet-to-scan-billions-of-ip-addresses/

- plenty of vulns that haven't seen exploits in the wild
    - eg pretty trivial RCE in OpenWRT





# IoT Malware

- IoT devices are often insecure by default
- users may not know how to secure them, or may not be able to
- however, they're very diverse, which makes malware-writing hard
- common security flaws:
    - bad default admin passwords
    - debugging/service portals left open 
    - dashboards exposed to the whole world instead of just LAN
    - no way to roll out security updates
- most malware just SYN scans a bunch of SSH/Telnet/ADB ports

- IoT malware examples:
    - Mirai https://en.wikipedia.org/wiki/Mirai_(malware)
    - Remaiten https://en.wikipedia.org/wiki/Remaiten
    - other spam botnets https://www.bbc.com/news/technology-25780908

- physical security threats don't spread as viruses




# Android Malware

- mostly installed via social engineering
    - technical exploits are secondary
- may be purposefully installed by someone else on the victim's phone

- Android malware examples:
    - (old) rooting malware https://www.f-secure.com/v-descs/trojan-android-ginmaster.shtml
    - malicious VPNs https://news.ycombinator.com/item?id=36382700
    - stalkerware https://techcrunch.com/2022/02/22/remove-android-spyware/












# Desktop Linux Malware

- There isn't very much of this.

- Desktop Linux systems are generally patched quickly
- Security-focused development by established groups, as opposed to router/IoT dev
- Targets not "worth it" -- there's way more malware written for Linux servers than desktops

- Desktop malware examples:
    - one old malicious screensaver https://lwn.net/Articles/367874/
    - fractureiser (cross-platform) https://github.com/fractureiser-investigation/fractureiser/
    - malicious Python packages https://blog.sonatype.com/python-packages-upload-your-aws-keys-env-vars-secrets-to-web









